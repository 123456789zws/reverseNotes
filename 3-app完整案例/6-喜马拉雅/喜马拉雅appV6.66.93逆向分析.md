# 账号密码登录



6.66.99.3 下载链接 https://www.wandoujia.com/apps/306673/history_v298



## 抓包分析

![1748841181241](assets/1748841181241.png)



## 定位密码加密

![1748841215923](assets/1748841215923.png)

![1748841228134](assets/1748841228134.png)

![1748841242079](assets/1748841242079.png)

挺多地方调用了，hook看一下

![1748841288331](assets/1748841288331.png)



![1748841363272](assets/1748841363272.png)

![1748841381701](assets/1748841381701.png)

![1748841401374](assets/1748841401374.png)



打印了3处，第二个什么handle，dispatch的，和登录好像关系不大；而且还是安卓系统的；

我们看两外两个，好像都被a.a调用



![1748841543633](assets/1748841543633.png)

好几个重载，我们前面的那个函数是string返回，所以这里是第四个

![1748841753539](assets/1748841753539.png)

我们hook一下看看入参和返回值

![1748841849801](assets/1748841849801.png)

第一个是什么nonce的，估计与抓包的nonce有关



## nonce参数

![1748841895477](assets/1748841895477.png)

所以nonce参数是发请求拿到的

我们去看一下这个nonce参数

![1748942622066](assets/1748942622066.png)

验证了一下，没啥需要带的

![1748942667401](assets/1748942667401.png)





我们继续定位密码

## 继续定位密码

我们继续看第二个，链接一样，我们只能继续跟栈

![1748841990457](assets/1748841990457.png)

![1748842126313](assets/1748842126313.png)

这里hook一下看一下入参和map内容

![1748842678547](assets/1748842678547.png)

![1748842697431](assets/1748842697431.png)

没问题，确实走的这里；但是这个时候已经赋值好了，我们去找map传入的地方



继续跟栈到run方法

![1748942858480](assets/1748942858480.png)



看样子是类被实例化的时候就加密好然后传进去了



hook一下实例化方法跟栈



![1748943261667](assets/1748943261667.png)



![1748943721868](assets/1748943721868.png)



这一次实例化的时候传入了参数

直接跟到request

![1748943890675](assets/1748943890675.png)



发现这里数据是匿名类12实例化传进来的

![1748943932188](assets/1748943932188.png)



hook一下实例化方法



![1748944039425](assets/1748944039425.png)



这个时候传进来了，跟栈看一下



![1748944112343](assets/1748944112343.png)

搜了一下这个函数，原来有好几个，不过好歹兜兜转转找到了

![1748944209330](assets/1748944209330.png)

hook了一下，确实是我们传入的账号密码

![1748944256997](assets/1748944256997.png)

![1748944278132](assets/1748944278132.png)

一路点击

![1748944293690](assets/1748944293690.png)



终于跟到了，加密在so里面



先看一下so写的难不难，太难了我们直接unidbg吧



先看下注册方式

![1748944452859](assets/1748944452859.png)



好的，静态注册



![1748944587395](assets/1748944587395.png)



这里代码还挺简单的，这里的v7是jstring，传入了两个jstring进去，然后v6不知道是什么

先看一下这个 `byte_D870`

![1748944657805](assets/1748944657805.png)

写死在程序里的，可能是什么公钥什么的？看不懂，所以这里的v5是一个固定的jstring



我们看下面那个函数做了什么

![1748944815699](assets/1748944815699.png)

好好好，这么玩。经典控制流混淆

> 我啥也不想看，我只想unidbg
> 不过在unidbg之前，我们可以观察一下



## signnature

单纯不是很好搜

![1748942275206](assets/1748942275206.png)

即使加上put也不是很好搜

![1748942322218](assets/1748942322218.png)



搜一下链接



用java的加密算法自吐脚本





![1748845078515](assets/1748845078515.png)

sha1加密



![1748844637105](assets/1748844637105.png)





py代码还原

![1748941991534](assets/1748941991534.png)

调用的时候把请求体字典传进来就行





## fdsOtp

这个参数也是其他接口返回回来的

> 经测试，默认是不会出滑块的，如果你没有带cookie就会出；

py代码还原如下



![1748942083874](assets/1748942083874.png)



