本系列教程会包含很多网上已有内容，有些是复制粘贴的，一般会注明来源；有些是根据经验进行总结的；

# 安卓逆向扫盲

什么是逆向？ 学术点叫**逆向工程**，逆向工程是将机器才能够懂的机器代码（0101二进制代码）翻译成人能够读懂的代码（汇编、smali代码）。

实际情况是，我们拿到开发者发布出来的文件，再从中提取出代码从而进行分析。如果是js逆向，代码可以在浏览器开发者工具看到；

而我们所做的逆向工程，主要是从浩如烟海的代码中 **寻找关键部分**，结合代码逻辑去理解其业务。

目前市面上的常见逆向分类：

- js逆向
- app逆向
- win逆向

而我们分析的，主要是app逆向中的安卓逆向；



## Android逆向

对已经发布的Android引用进行逆向工程，根据代码了解app内部工作原理；

由于逆向工程的敏感性，Android逆向可以实现的功能比较多；如：

- 开发：分析app业务代码，实现类似的功能；或直接对app进行二次开发；
- 爬虫：分析加密参数，用于爬虫；
- 破解：去除vip限制&广告；
- 网络安全：寻找漏洞或业务bug，向src提交；
- 黑客：攻击应用程序，渗透，勒索，劫持，制作钓鱼app，骗取信息；

> 逆向是一把双刃剑；如果你把他用好了，可以快速提升；如果没用好，被追责很容易进去；



## 电脑和手机要求

1. 电脑：主要是内存要够大；一般至少16G，这个量分析现在的一些大app，基本上会很卡，而且有可能反编译不全；

   虽然也有其他办法能解决，但是吃力不讨好；不如直接搞个32G的电脑，最好是买个台式机（性能更好）；

   > 本人电脑，仅供参考；
   >
   > （1）台式：系统是win10，内存是64G，CPU是i5-13490F，GPU是FTX4060； 2年前买的，￥6000；
   >
   > （2）笔记本：系统是win10，内存是16G，CPU是i5-1035G1，GPU是核显； 5年前买的，￥5000；



2. 手机：

   - 模拟器：root方便，且可以制作快照，但是存在非常多的问题；

   - 真机：选一个**方便解bl锁**的手机就行，主要是拿root权限；

     推荐：pixel，其余：小米老机型、一加、oppo、vivo；

   > 本人真机，仅供参考；下面的价格浮动，请自行搜索；
   >
   > (1) pixel 2xl；专门为逆向买的，目前淘宝 二手￥300；
   >
   > (2) redmi note7pro；8年前买的旧手机，目前淘宝 二手￥230不等；
   >
   > (3) redmi k30pro；5年前买的旧手机，目前淘宝 二手￥300不等；
   >
   > (4) 后续会购买高版本pixel；

   





## 现有教程

1. 免费教程，基本都是个人为爱发电，一般是介绍一下过往逆向技术，实践一般是自己写个demo，不拿市面上app做案例；
   - 正己 《安卓逆向这档事》2022-2024 -- 吾爱破解论坛，b站均可学习；
   - 会飞的丑小鸭 《叫我兄弟学逆向》2017-2024 -- 吾爱破解论坛；
2. 付费教程，一般分为机构和个人；
   - 机构
     - 路飞
   - 个人



付费课程，主要可以分为两类：

- 个人教程

- 免费教程

  1. 








## 安卓逆向特点

安卓app市场大，且不易被淘汰，至少还能坚持几十年；

安卓源码公开，可以通过分析源码来理解app；但也有缺点，有些



## 按照语言类型分类

首先我们把常用的编程语言进行分类，主要是两类；

- 解释型语言
- 编译型语言

`解释型语言`(如Java)的运行环境是JVM之类的虚拟机，其反编译的难度通常较低。以Java语言为例，编译器编译的结果通常是*.class*或者*.dex*文件，在没有做代码混淆的情况下，很容易反汇编出Java源码，分析出代码逻辑。而且混淆也只是将类、方法、变量名称替换成*a* *b* *c* *d*这种没有任何意义的名字，增加理解难度而已。



`编译型语言`(如C/C++，Objective-C等)最终编译出来的机器代码就比较复杂，因为其机器代码是跟CPU架构相关的，因此针对不同的CPU架构编译出来的二进制文件是不同的，反汇编得到的代码也会不一样。往往需要针对特定的CPU架构去解读汇编语言，才能正确的分析出结果出来，这就需要对不同架构CPU的寄存器、寻址方式等特性有所了解才行。另外二进制文件反汇编出来的函数、变量名通常是机器生成的无意义字符串，所以分析难度通常相较于解释型语言会更大一些。

> 因此，汇编对于逆向工程是基础；





## 常用分析手段

1. 静态分析

   将机器代码反汇编成方便人类理解的代码，如smali代码（Java）、汇编代码或汇编代码翻译的C语言伪代码等等，通过分析这些比较低级的编程语言的代码，找到程序的业务流程或参数的加密逻辑；

   

2. 动态调试分析

   通过断点调试手段，让程序单步执行进行分析。动态分析往往是在静态分析出一定的结果的基础上进行，找到合适的地方给代码打断点，即时地读取当前变量的值，来进一步分析程序的逻辑、获取程序关系数据。

   常用的是 hook技术 和 程序断点调试；

   

3. 网络流量分析（抓包分析）

   通过代理方式或者其他方式，截取程序与服务器通信的数据流量（抓包），来分析客户端和服务端的通信协议。

   

4. 合理**猜测**

   根据正向开发流程来进行合理猜测，**这是最常用也最有有效的**，但不一定是最准确的；

   想要提高猜测的准度，就得积累编程经验、了解程序设计模式、学会查框架使用说明、学习读开源代码等等；





## 加密参数逆向方法

1. 纯算：**基于源码还原加密逻辑**：直接分析并实现加密算法；

2. 黑盒：**补环境复制代码进行模拟**：搭建完整的运行环境，将原有加密代码移植到新环境中运行；

   例如：js逆向补浏览器环境；app逆向用unidbg补jni环境；

3. rpc：**远程调用**：通过远程调用的方式直接复用目标环境的加密逻辑。





## 关于App逆向

根据开发方式而导致逆向方式而有所不同

接下来我们先对开发方式进行分类，并给出常用逆向路线

### 原生开发 

Native App Development

**特点**：最高性能，最佳用户体验，完整设备功能访问
**适用**：高性能应用、游戏、复杂交互应用

| 操作系统 | 应用层语言                 | native层    | 开发工具                                | 包的管理                                  | 使用框架                                                     | 部署平台                      |
| :------- | :------------------------- | ----------- | :-------------------------------------- | :---------------------------------------- | :----------------------------------------------------------- | ----------------------------- |
| Android  | java<br />kotlin           | .so via JNI | Android Studio<br />adb<br />firebase   | maven<br />gradle                         | **Jetpack Compose(现代)** <br />Android SDK<br />Room<br />WorkManager | Google Play<br />其他应用商店 |
| Ios      | **swift**<br />objective-c | .dylib /.a  | xcode<br />Instruments <br />TestFlight | **Swift Package Manager**,<br />CocoaPods | UIKit<br />SwiftUI<br />Core Data<br />Core ML<br />ARKit    | App Store                     |

安卓逆向（大部分）：

- 用反编译工具 反编译 dex文件 去看java代码

  > jadx，jeb，gda
  >
  > 大部分是：dex -> smail -> java

- 用反编译工具 反编译 so文件看 native层代码

  > ida、

  





### 跨平台开发

Cross-Platform

一般都是使用开发框架来生成不同平台的代码

**特点**：一次编写多端运行

| 框架                     | 技术栈      | 渲染方式        | 代表应用             | 优势                 |
| :----------------------- | :---------- | :-------------- | :------------------- | :------------------- |
| **React Native**         | JS/TS+React | 原生组件桥接    | Facebook, Skype，ins | 热更新，丰富生态     |
| **Flutter**              | Dart        | Skia自绘引擎    | Google Pay           | 高性能，UI一致性     |
| **Xamarin**              | C#          | 原生绑定        | UPS, Alaska Air      | .NET生态集成         |
| **Kotlin Multiplatform** | Kotlin      | 共享逻辑+原生UI | Netflix, Philips     | 原生性能，无缝互操作 |

这里比较常见的有 flutter 开发的app；这里提一嘴，棋牌类游戏用lua脚本写加密逻辑，然后用cocos2dlua框架加载lua脚本；



我这里只给出 flutter 开发的app的逆向方法：

1. 拿到libapp.so，对其使用针对性工具如reflutter和blutter初步处理
2. 结合ida·分析代码





### h5开发

webview调试即可

但是有的好像有V8调用js进行加密，但是我还不知道怎么解决







## 安卓逆向都要学什么

